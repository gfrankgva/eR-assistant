javascript:(function(){if(document.getElementById('bpa-widget')){return;}const s=document.createElement('style');s.textContent='*{margin:0;padding:0;box-sizing:border-box}#bpa-widget{position:fixed;top:0;right:-450px;width:450px;height:100vh;background:#fff;box-shadow:-4px 0 24px rgba(0,0,0,0.12);z-index:999999;display:flex;flex-direction:column;transition:right 0.3s;border-left:1px solid #e0e0e0}#bpa-widget.open{right:0}.toggle-btn{position:fixed;right:0;top:50%;transform:translateY(-50%);background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;width:48px;height:120px;border-radius:8px 0 0 8px;cursor:pointer;font-size:14px;font-weight:600;writing-mode:vertical-rl;z-index:999998;box-shadow:-2px 2px 12px rgba(0,0,0,0.15)}.toggle-btn.hidden{display:none}.widget-header{background:linear-gradient(135deg,#667eea,#764ba2);padding:24px;color:#fff}.section{background:#fff;border:1px solid #e5e5e5;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 1px 3px rgba(0,0,0,0.05)}.upload-area{border:2px dashed #d0d0d0;border-radius:8px;padding:32px;text-align:center;cursor:pointer;background:#fafafa}.health-item{display:flex;align-items:center;justify-content:space-between;padding:12px;background:#f8f8f8;border-radius:8px;border-left:3px solid #e0e0e0;margin-bottom:10px}.health-item.error{border-left-color:#ef4444;background:#fef2f2}.health-item.warning{border-left-color:#f59e0b;background:#fffbeb}.health-item.success{border-left-color:#10b981;background:#f0fdf4}';document.head.appendChild(s);const w=document.createElement('div');w.id='bpa-widget';w.innerHTML='<div class="widget-header"><div style="display:flex;justify-content:space-between;align-items:flex-start"><div><h1 style="font-size:20px;font-weight:600;margin-bottom:4px">ğŸ” BPA Analyzer</h1><div style="font-size:13px;opacity:0.9">Phase 2</div></div><button onclick="document.getElementById(\'bpa-widget\').classList.remove(\'open\')" style="background:rgba(255,255,255,0.2);border:none;color:#fff;width:32px;height:32px;border-radius:8px;cursor:pointer;font-size:18px">Ã—</button></div></div><div style="flex:1;overflow-y:auto;padding:24px;background:#fafafa"><div class="section"><div style="font-size:15px;font-weight:600;margin-bottom:16px">ğŸ“¤ Upload JSON</div><div class="upload-area" onclick="document.getElementById(\'bpa-file\').click()"><div style="font-size:32px;margin-bottom:12px">ğŸ“„</div><div style="font-size:14px;color:#666">Click to upload</div></div><input type="file" id="bpa-file" accept=".json" style="display:none"></div><div id="bpa-results"></div></div>';document.body.appendChild(w);const t=document.createElement('button');t.className='toggle-btn';t.textContent='BPA Analyzer';t.onclick=()=>{w.classList.toggle('open');t.classList.toggle('hidden')};document.body.appendChild(t);document.getElementById('bpa-file').onchange=function(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=function(ev){try{const d=JSON.parse(ev.target.result);const b=d.bots||[];const a=d.actions||[];let h='<div class="section"><h3>ğŸ“Š Overview</h3><div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:16px 0"><div style="background:#f6f8fb;padding:16px;border-radius:8px"><div style="font-size:28px;font-weight:700;color:#667eea">'+b.length+'</div><div style="font-size:12px;color:#666">BOTs</div></div><div style="background:#f6f8fb;padding:16px;border-radius:8px"><div style="font-size:28px;font-weight:700;color:#667eea">'+a.length+'</div><div style="font-size:12px;color:#666">Actions</div></div></div></div>';const ids=new Set(b.map(x=>x.id));let br=0,um=0,db=0;const u=new Set();a.forEach(x=>{if(!x.mappings||!x.mappings.length)um++;if(x.mappings)x.mappings.forEach(m=>{if(m.sourceBotId&&!ids.has(m.sourceBotId))br++;if(m.targetBotId&&!ids.has(m.targetBotId))br++;if(m.sourceBotId)u.add(m.sourceBotId);if(m.targetBotId)u.add(m.targetBotId)})});db=b.length-u.size;h+='<div class="section"><h3>ğŸ¥ Health</h3>';h+='<div class="health-item '+(br===0?'success':'error')+'"><span>'+(br===0?'âœ…':'ğŸš¨')+' Broken Refs</span><span>'+br+'</span></div>';h+='<div class="health-item '+(um===0?'success':'warning')+'"><span>'+(um===0?'âœ…':'âš ï¸')+' Unmapped</span><span>'+um+'</span></div>';h+='<div class="health-item '+(db===0?'success':'info')+'"><span>'+(db===0?'âœ…':'ğŸ—‘ï¸')+' Dead BOTs</span><span>'+db+'</span></div>';h+='</div>';document.getElementById('bpa-results').innerHTML=h}catch(err){alert('Error: '+err.message)}};r.readAsText(f)};console.log('âœ… BPA Phase 2 loaded')})();
